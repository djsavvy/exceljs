{"version":3,"file":"cache-field.js","names":["CacheField","constructor","_ref","name","sharedItems","render","concat","length","map","item","join","module","exports"],"sources":["../../../../../lib/xlsx/xform/pivot-table/cache-field.js"],"sourcesContent":["class CacheField {\r\n  constructor({name, sharedItems}) {\r\n    // string type\r\n    //\r\n    // {\r\n    //   'name': 'A',\r\n    //   'sharedItems': ['a1', 'a2', 'a3']\r\n    // }\r\n    //\r\n    // or\r\n    //\r\n    // integer type\r\n    //\r\n    // {\r\n    //   'name': 'D',\r\n    //   'sharedItems': null\r\n    // }\r\n    this.name = name;\r\n    this.sharedItems = sharedItems;\r\n  }\r\n\r\n  render() {\r\n    // PivotCache Field: http://www.datypic.com/sc/ooxml/e-ssml_cacheField-1.html\r\n    // Shared Items: http://www.datypic.com/sc/ooxml/e-ssml_sharedItems-1.html\r\n\r\n    // integer types\r\n    if (this.sharedItems === null) {\r\n      // TK(2023-07-18): left out attributes... minValue=\"5\" maxValue=\"45\"\r\n      return `<cacheField name=\"${this.name}\" numFmtId=\"0\">\r\n      <sharedItems containsSemiMixedTypes=\"0\" containsString=\"0\" containsNumber=\"1\" containsInteger=\"1\" />\r\n    </cacheField>`;\r\n    }\r\n\r\n    // string types\r\n    return `<cacheField name=\"${this.name}\" numFmtId=\"0\">\r\n      <sharedItems count=\"${this.sharedItems.length}\">\r\n        ${this.sharedItems.map(item => `<s v=\"${item}\" />`).join('')}\r\n      </sharedItems>\r\n    </cacheField>`;\r\n  }\r\n}\r\n\r\nmodule.exports = CacheField;\r\n"],"mappings":";;AAAA,MAAMA,UAAU,CAAC;EACfC,WAAWA,CAAAC,IAAA,EAAsB;IAAA,IAArB;MAACC,IAAI;MAAEC;IAAW,CAAC,GAAAF,IAAA;IAC7B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,WAAW,GAAGA,WAAW;EAChC;EAEAC,MAAMA,CAAA,EAAG;IACP;IACA;;IAEA;IACA,IAAI,IAAI,CAACD,WAAW,KAAK,IAAI,EAAE;MAC7B;MACA,6BAAAE,MAAA,CAA4B,IAAI,CAACH,IAAI;IAGvC;;IAEA;IACA,6BAAAG,MAAA,CAA4B,IAAI,CAACH,IAAI,qDAAAG,MAAA,CACb,IAAI,CAACF,WAAW,CAACG,MAAM,mBAAAD,MAAA,CACzC,IAAI,CAACF,WAAW,CAACI,GAAG,CAACC,IAAI,cAAAH,MAAA,CAAaG,IAAI,UAAM,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC;EAGlE;AACF;AAEAC,MAAM,CAACC,OAAO,GAAGZ,UAAU","ignoreList":[]}