{"version":3,"file":"ext-lst-xform.js","names":["CompositeXform","require","ConditionalFormattingsExt","ExtXform","constructor","map","conditionalFormattings","tag","hasContent","model","prepare","options","render","xmlStream","openNode","uri","closeNode","createNewModel","onParserClose","name","parser","ExtLstXform","ext","Object","assign","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/ext-lst-xform.js"],"sourcesContent":["/* eslint-disable max-classes-per-file */\r\nconst CompositeXform = require('../composite-xform');\r\n\r\nconst ConditionalFormattingsExt = require('./cf-ext/conditional-formattings-ext-xform');\r\n\r\nclass ExtXform extends CompositeXform {\r\n  constructor() {\r\n    super();\r\n    this.map = {\r\n      'x14:conditionalFormattings': (this.conditionalFormattings = new ConditionalFormattingsExt()),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'ext';\r\n  }\r\n\r\n  hasContent(model) {\r\n    return this.conditionalFormattings.hasContent(model.conditionalFormattings);\r\n  }\r\n\r\n  prepare(model, options) {\r\n    this.conditionalFormattings.prepare(model.conditionalFormattings, options);\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.openNode('ext', {\r\n      uri: '{78C0D931-6437-407d-A8EE-F0AAD7539E65}',\r\n      'xmlns:x14': 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/main',\r\n    });\r\n\r\n    this.conditionalFormattings.render(xmlStream, model.conditionalFormattings);\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  createNewModel() {\r\n    return {};\r\n  }\r\n\r\n  onParserClose(name, parser) {\r\n    this.model[name] = parser.model;\r\n  }\r\n}\r\n\r\nclass ExtLstXform extends CompositeXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      ext: (this.ext = new ExtXform()),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'extLst';\r\n  }\r\n\r\n  prepare(model, options) {\r\n    this.ext.prepare(model, options);\r\n  }\r\n\r\n  hasContent(model) {\r\n    return this.ext.hasContent(model);\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (!this.hasContent(model)) {\r\n      return;\r\n    }\r\n\r\n    xmlStream.openNode('extLst');\r\n    this.ext.render(xmlStream, model);\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  createNewModel() {\r\n    return {};\r\n  }\r\n\r\n  onParserClose(name, parser) {\r\n    Object.assign(this.model, parser.model);\r\n  }\r\n}\r\n\r\nmodule.exports = ExtLstXform;\r\n"],"mappings":";;AAAA;AACA,MAAMA,cAAc,GAAGC,OAAO,CAAC,oBAAoB,CAAC;AAEpD,MAAMC,yBAAyB,GAAGD,OAAO,CAAC,4CAA4C,CAAC;AAEvF,MAAME,QAAQ,SAASH,cAAc,CAAC;EACpCI,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IACP,IAAI,CAACC,GAAG,GAAG;MACT,4BAA4B,EAAG,IAAI,CAACC,sBAAsB,GAAG,IAAIJ,yBAAyB,CAAC;IAC7F,CAAC;EACH;EAEA,IAAIK,GAAGA,CAAA,EAAG;IACR,OAAO,KAAK;EACd;EAEAC,UAAUA,CAACC,KAAK,EAAE;IAChB,OAAO,IAAI,CAACH,sBAAsB,CAACE,UAAU,CAACC,KAAK,CAACH,sBAAsB,CAAC;EAC7E;EAEAI,OAAOA,CAACD,KAAK,EAAEE,OAAO,EAAE;IACtB,IAAI,CAACL,sBAAsB,CAACI,OAAO,CAACD,KAAK,CAACH,sBAAsB,EAAEK,OAAO,CAAC;EAC5E;EAEAC,MAAMA,CAACC,SAAS,EAAEJ,KAAK,EAAE;IACvBI,SAAS,CAACC,QAAQ,CAAC,KAAK,EAAE;MACxBC,GAAG,EAAE,wCAAwC;MAC7C,WAAW,EAAE;IACf,CAAC,CAAC;IAEF,IAAI,CAACT,sBAAsB,CAACM,MAAM,CAACC,SAAS,EAAEJ,KAAK,CAACH,sBAAsB,CAAC;IAE3EO,SAAS,CAACG,SAAS,CAAC,CAAC;EACvB;EAEAC,cAAcA,CAAA,EAAG;IACf,OAAO,CAAC,CAAC;EACX;EAEAC,aAAaA,CAACC,IAAI,EAAEC,MAAM,EAAE;IAC1B,IAAI,CAACX,KAAK,CAACU,IAAI,CAAC,GAAGC,MAAM,CAACX,KAAK;EACjC;AACF;AAEA,MAAMY,WAAW,SAASrB,cAAc,CAAC;EACvCI,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IAEP,IAAI,CAACC,GAAG,GAAG;MACTiB,GAAG,EAAG,IAAI,CAACA,GAAG,GAAG,IAAInB,QAAQ,CAAC;IAChC,CAAC;EACH;EAEA,IAAII,GAAGA,CAAA,EAAG;IACR,OAAO,QAAQ;EACjB;EAEAG,OAAOA,CAACD,KAAK,EAAEE,OAAO,EAAE;IACtB,IAAI,CAACW,GAAG,CAACZ,OAAO,CAACD,KAAK,EAAEE,OAAO,CAAC;EAClC;EAEAH,UAAUA,CAACC,KAAK,EAAE;IAChB,OAAO,IAAI,CAACa,GAAG,CAACd,UAAU,CAACC,KAAK,CAAC;EACnC;EAEAG,MAAMA,CAACC,SAAS,EAAEJ,KAAK,EAAE;IACvB,IAAI,CAAC,IAAI,CAACD,UAAU,CAACC,KAAK,CAAC,EAAE;MAC3B;IACF;IAEAI,SAAS,CAACC,QAAQ,CAAC,QAAQ,CAAC;IAC5B,IAAI,CAACQ,GAAG,CAACV,MAAM,CAACC,SAAS,EAAEJ,KAAK,CAAC;IACjCI,SAAS,CAACG,SAAS,CAAC,CAAC;EACvB;EAEAC,cAAcA,CAAA,EAAG;IACf,OAAO,CAAC,CAAC;EACX;EAEAC,aAAaA,CAACC,IAAI,EAAEC,MAAM,EAAE;IAC1BG,MAAM,CAACC,MAAM,CAAC,IAAI,CAACf,KAAK,EAAEW,MAAM,CAACX,KAAK,CAAC;EACzC;AACF;AAEAgB,MAAM,CAACC,OAAO,GAAGL,WAAW","ignoreList":[]}