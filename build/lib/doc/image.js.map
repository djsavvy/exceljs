{"version":3,"file":"image.js","names":["colCache","require","Anchor","Image","constructor","worksheet","model","type","imageId","hyperlinks","range","tl","br","ext","editAs","Error","_ref","decoded","decode","col","left","row","top","right","bottom","module","exports"],"sources":["../../../lib/doc/image.js"],"sourcesContent":["const colCache = require('../utils/col-cache');\r\nconst Anchor = require('./anchor');\r\n\r\nclass Image {\r\n  constructor(worksheet, model) {\r\n    this.worksheet = worksheet;\r\n    this.model = model;\r\n  }\r\n\r\n  get model() {\r\n    switch (this.type) {\r\n      case 'background':\r\n        return {\r\n          type: this.type,\r\n          imageId: this.imageId,\r\n        };\r\n      case 'image':\r\n        return {\r\n          type: this.type,\r\n          imageId: this.imageId,\r\n          hyperlinks: this.range.hyperlinks,\r\n          range: {\r\n            tl: this.range.tl.model,\r\n            br: this.range.br && this.range.br.model,\r\n            ext: this.range.ext,\r\n            editAs: this.range.editAs,\r\n          },\r\n        };\r\n      default:\r\n        throw new Error('Invalid Image Type');\r\n    }\r\n  }\r\n\r\n  set model({type, imageId, range, hyperlinks}) {\r\n    this.type = type;\r\n    this.imageId = imageId;\r\n\r\n    if (type === 'image') {\r\n      if (typeof range === 'string') {\r\n        const decoded = colCache.decode(range);\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, {col: decoded.left, row: decoded.top}, -1),\r\n          br: new Anchor(this.worksheet, {col: decoded.right, row: decoded.bottom}, 0),\r\n          editAs: 'oneCell',\r\n        };\r\n      } else {\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, range.tl, 0),\r\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\r\n          ext: range.ext,\r\n          editAs: range.editAs,\r\n          hyperlinks: hyperlinks || range.hyperlinks,\r\n        };\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = Image;\r\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAoB,CAAC;AAC9C,MAAMC,MAAM,GAAGD,OAAO,CAAC,UAAU,CAAC;AAElC,MAAME,KAAK,CAAC;EACVC,WAAWA,CAACC,SAAS,EAAEC,KAAK,EAAE;IAC5B,IAAI,CAACD,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,KAAK,GAAGA,KAAK;EACpB;EAEA,IAAIA,KAAKA,CAAA,EAAG;IACV,QAAQ,IAAI,CAACC,IAAI;MACf,KAAK,YAAY;QACf,OAAO;UACLA,IAAI,EAAE,IAAI,CAACA,IAAI;UACfC,OAAO,EAAE,IAAI,CAACA;QAChB,CAAC;MACH,KAAK,OAAO;QACV,OAAO;UACLD,IAAI,EAAE,IAAI,CAACA,IAAI;UACfC,OAAO,EAAE,IAAI,CAACA,OAAO;UACrBC,UAAU,EAAE,IAAI,CAACC,KAAK,CAACD,UAAU;UACjCC,KAAK,EAAE;YACLC,EAAE,EAAE,IAAI,CAACD,KAAK,CAACC,EAAE,CAACL,KAAK;YACvBM,EAAE,EAAE,IAAI,CAACF,KAAK,CAACE,EAAE,IAAI,IAAI,CAACF,KAAK,CAACE,EAAE,CAACN,KAAK;YACxCO,GAAG,EAAE,IAAI,CAACH,KAAK,CAACG,GAAG;YACnBC,MAAM,EAAE,IAAI,CAACJ,KAAK,CAACI;UACrB;QACF,CAAC;MACH;QACE,MAAM,IAAIC,KAAK,CAAC,oBAAoB,CAAC;IACzC;EACF;EAEA,IAAIT,KAAKA,CAAAU,IAAA,EAAqC;IAAA,IAApC;MAACT,IAAI;MAAEC,OAAO;MAAEE,KAAK;MAAED;IAAU,CAAC,GAAAO,IAAA;IAC1C,IAAI,CAACT,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,OAAO,GAAGA,OAAO;IAEtB,IAAID,IAAI,KAAK,OAAO,EAAE;MACpB,IAAI,OAAOG,KAAK,KAAK,QAAQ,EAAE;QAC7B,MAAMO,OAAO,GAAGjB,QAAQ,CAACkB,MAAM,CAACR,KAAK,CAAC;QACtC,IAAI,CAACA,KAAK,GAAG;UACXC,EAAE,EAAE,IAAIT,MAAM,CAAC,IAAI,CAACG,SAAS,EAAE;YAACc,GAAG,EAAEF,OAAO,CAACG,IAAI;YAAEC,GAAG,EAAEJ,OAAO,CAACK;UAAG,CAAC,EAAE,CAAC,CAAC,CAAC;UACzEV,EAAE,EAAE,IAAIV,MAAM,CAAC,IAAI,CAACG,SAAS,EAAE;YAACc,GAAG,EAAEF,OAAO,CAACM,KAAK;YAAEF,GAAG,EAAEJ,OAAO,CAACO;UAAM,CAAC,EAAE,CAAC,CAAC;UAC5EV,MAAM,EAAE;QACV,CAAC;MACH,CAAC,MAAM;QACL,IAAI,CAACJ,KAAK,GAAG;UACXC,EAAE,EAAE,IAAIT,MAAM,CAAC,IAAI,CAACG,SAAS,EAAEK,KAAK,CAACC,EAAE,EAAE,CAAC,CAAC;UAC3CC,EAAE,EAAEF,KAAK,CAACE,EAAE,IAAI,IAAIV,MAAM,CAAC,IAAI,CAACG,SAAS,EAAEK,KAAK,CAACE,EAAE,EAAE,CAAC,CAAC;UACvDC,GAAG,EAAEH,KAAK,CAACG,GAAG;UACdC,MAAM,EAAEJ,KAAK,CAACI,MAAM;UACpBL,UAAU,EAAEA,UAAU,IAAIC,KAAK,CAACD;QAClC,CAAC;MACH;IACF;EACF;AACF;AAEAgB,MAAM,CAACC,OAAO,GAAGvB,KAAK","ignoreList":[]}